<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>My Phaser Game</title>
    <!-- Explicitly use https protocol with the CDN -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #2d2d2d;
        }
    </style>
</head>
<body>
    <div id="phaser-game"></div>

    <script>
        // Wait for the document to fully load before starting Phaser
        document.addEventListener('DOMContentLoaded', function() {
            // Check if Phaser loaded successfully
            if (typeof Phaser === 'undefined') {
                document.getElementById('phaser-game').innerHTML = 
                    'Error: Phaser library not loaded. Check console for details.';
                console.error('Phaser library failed to load');
                return;
            }

            const config = {
                type: Phaser.AUTO,
                width: 800,
                height: 600,
                parent: 'phaser-game',
                backgroundColor: '#000000',
                physics: {
                    default: "arcade",
                    arcade: {
                        gravity: { y: 200 },
                        debug: false
                    },
                },
                scene: {
                    preload: preload,
                    create: create,
                }
            };

            const game = new Phaser.Game(config);

            function preload() {
                this.load.setBaseURL("https://labs.phaser.io");
                this.load.image("sky", "assets/skies/space3.png");
                this.load.image("plane", "assets/sprites/ww2plane.png");
                this.load.image("green", "assets/particles/green.png");
                this.load.image("astroid", "assets/games/asteroids/asteroid1.png");
                this.load.image("astroid2", "assets/games/asteroids/asteroid1.png");
                this.load.image("astroid3", "assets/games/asteroids/asteroid1.png");
            }

            function create() {
                this.add.image(400, 300, "sky");
                this.add.image(700, 300, "astroid");
                this.add.image(100, 200, "astroid2");
                this.add.image(400, 40, "astroid3");
                
                const particles = this.add.particles("green");
                const emitter = particles.createEmitter({
                    speed: 100,
                    scale: { start: 1, end: 0 },
                    blendMode: "ADD",
                });
                
                const plane = this.physics.add.image(400, 100, "plane");
                plane.setVelocity(100, 200);
                plane.setBounce(1, 1);
                plane.setCollideWorldBounds(true);
                emitter.startFollow(plane);
            }
        });
    </script>
</body>
</html>